<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
            <title>Intalling the PHP Driver - Kristina Chodorow - 10gen Confluence</title>
    
        
        
        
        
        

                        
        
    
    
            
<meta id="confluence-context-path" name="confluence-context-path" content="">
<meta id="confluence-space-key" name="confluence-space-key" content="~kristina">

<script type="text/javascript">
    // Deprecated global variables. To be removed in a future version of Confluence.
    var contextPath = '';
    var i18n = [];
</script>

    

    
</head>

            <body onload="placeFocus()" id="com-atlassian-confluence">
    


    <script type="text/javascript">
        AJS.toInit(function ($) {
            $(".message-close-button").each(function () {
                var li = $(this).parent();
                var cookieId = this.alt;
                $(this).click(function () {
                    li.slideUp();
                    setCookie(cookieId, true);
                });
            });

            $("#messageContainer .confluence-messages").each(function () {
                if (!getCookie(this.id)) {
                    $(this).show();
                }
            })
        });
    </script>

        
<div id="main">

    <h1 id="title-heading" class="pagetitle">
		<span id="title-text">
					            Intalling the PHP Driver
    				</span>
    </h1>

    <!--
    Root decorator: this is a layer of abstraction that Confluence doesn't need. It will be removed eventually.
-->




    
    

    
    
        
    
    
                    
        
    

    


<div id="content" class="page view">
    
        
    
                                
        
    

                    

        
        <div class="page-metadata">
    <ul class="page-metadata-icons">
        </ul>
            Added by <a href="/display/~kristina">Kristina Chodorow</a>, last edited by <a href="/display/~kristina">Kristina Chodorow</a> on Feb 19, 2009
                            <span class="noprint">&nbsp;(<a href="/pages/diffpages.action?pageId=590090&originalId=590220">view change</a>)</span>
                </div>        
        <div class="wiki-content">
           <!-- wiki content -->
            <div>
<ul>
    <li><a href='#IntallingthePHPDriver-UnpackingandConfigurationOptions'>Unpacking and Configuration Options</a></li>
    <li><a href='#IntallingthePHPDriver-Unix%2FLinuxInstall'>Unix/Linux Install</a></li>
    <li><a href='#IntallingthePHPDriver-OSXInstall'>OS X Install</a></li>
    <li><a href='#IntallingthePHPDriver-Configuration'>Configuration</a></li>
</ul></div>
<h1><a name="IntallingthePHPDriver-UnpackingandConfigurationOptions"></a>Unpacking and Configuration Options</h1>

<p>Download the driver and untar it.</p>

<p><div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">$ tar zxvf mongo-php-driver-version.tar.gz
$ cd mongo-php-driver-version
</pre>
</div></div>Instead of using Makefiles, the driver is compiled and installed by <a href="http://www.scons.org" rel="nofollow">SCons</a>.</p>

<p>By default, the driver assumes that the database is installed in <tt>/opt/mongo</tt>.&nbsp; If you have installed Mongo in a different location, you can specify it with the <tt>&#45;-mongodb</tt> option:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">$ sudo scons --mongodb /path/to/mongodb install
</pre>
</div></div>
<p>The driver will try to determine where to put the extension by running <tt>php &#45;i &#124; grep extension_dir</tt>.  If you wish to put the shared library somewhere else, use the <tt>&#45;-extension&#45;dir</tt> option to specify a different path.</p>

<p>If you wish to use the 64 bit database with the driver, you must build the driver with the flag <tt>&#45;-64</tt>.</p>

<h1><a name="IntallingthePHPDriver-Unix%2FLinuxInstall"></a>Unix/Linux Install</h1>

<p>To compile and install:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">$ sudo scons install</pre>
</div></div>
<h1><a name="IntallingthePHPDriver-OSXInstall"></a>OS X Install</h1>

<p>Make sure you have the 64-bit Mongo downloaded, as well as 64-bit Boost and PCRE libraries (see <a href="/display/DOCS/Building+for+OS+X" title="Building for OS X">Building for OS X</a>).  The PHP driver will not work if any of these are 32 bit and you are using OS X's built-in Apache&#33;</p>

<p>To install:</p>

<p><div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">$ sudo scons --mongodb /path/to/mongodb --mac-boost /path/to/boost/libs --64 install
</pre>
</div></div>If the database was able to find Boost when you built it, the driver should be able to, too, and you can leave the <tt>&#45;-mac-boost</tt> option out.</p>

<h1><a name="IntallingthePHPDriver-Configuration"></a>Configuration</h1>

<p>Make the following changes to <tt>php.ini</tt>:</p>
<ol>
	<li>Scons installs <tt>libmongo.so</tt> (or <tt>libmongo.dylib</tt>, on OS X) in your PHP extensions directory.  Check what directory this is using:
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">$ php -i | grep extension_dir
  extension_dir =&gt; /path/to/my/extensions =&gt; /path/to/my/extensions
  </pre>
</div></div>If you used the &#45;-extension-dir option to specify a different path, change <tt>extension_dir</tt> to the path you chose in <tt>php.ini</tt>: <div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">extension_dir = <span class="code-quote">"/path/to/my/extensions"</span>
  </pre>
</div></div></li>
	<li>Add the directory of the unpacked driver to PHP's include path. This way PHP can find the PHP files that come with the driver. <div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">include_path = <span class="code-quote">"&lt;previous includes&gt;:/home/user/mongo-php-driver/src/php"</span></pre>
</div></div></li>
	<li>Under <b>Dynamic Extensions</b>, add a line: <div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">extension=libmongo.so</pre>
</div></div> (or <tt>extension=libmongo.dylib</tt>, on a Mac)</li>
	<li>It is recommended that you also add a few lines defining a default host and port:
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">[mongo]
; Default host <span class="code-keyword">for</span> mongo connection
mongo.default_host = localhost

; Default port <span class="code-keyword">for</span> mongo database
mongo.default_port = 27017

; If the driver should reconnect to mongo
mongo.auto_reconnect = <span class="code-keyword">true</span>
  </pre>
</div></div>This allows you to say <tt>$m = new Mongo()</tt> instead of <tt>$m = new Mongo( "localhost", 27017, true )</tt> every time you connect to the database.</li>
</ol>


<p>Your driver should now be fully armed and operational&#33;  See the PHP tutorial to start using it.</p>
        </div>

        <!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
         xmlns:dc="http://purl.org/dc/elements/1.1/"
         xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
         <rdf:Description
    rdf:about="http://www.mongodb.org//display/~kristina/Intalling+the+PHP+Driver"
    dc:identifier="http://www.mongodb.org//display/~kristina/Intalling+the+PHP+Driver"
    dc:title="Intalling the PHP Driver"
    trackback:ping="http://www.mongodb.org//rpc/trackback/590090"/>
</rdf:RDF>
-->

</body>
</html>
